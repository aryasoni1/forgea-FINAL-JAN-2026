# Task A7 — Scripts & Commands

Date: 2026-02-06
Status: APPROVED

---

## Goal

Establish transparent, contributor-facing script guidance and enforced Turbo orchestration at the monorepo root by cataloguing the canonical `pnpm` commands, keeping all existing Turbo-backed scripts, and documenting any new tooling pins required to run them consistently.

---

## Docs Gatekeeper Findings (Advisory)

Source: /docs/docs-gatekeeper/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A7_Scripts & Commands.md

- Required documentation: pnpm CLI run semantics pinned to pnpm@10.28.1 and Turborepo orchestration guidelines (current Turbo version is flagged as "VERSION UNKNOWN — MUST BE PINNED").
- Internal doc expectations: capture Turbo delegation and script conventions (e.g., in a new /docs/official-docs/EPIC-A/A7_scripts_official.md) and cite the same pinned tooling versions.
- Risk signal: absence of a conventional README leaves contributors without human-facing guidance beyond `.github/copilot-instructions.md`.
- Blocker: Turbo version must be named before implementation can proceed.

---

## Documentation Registry Alignment

Source: /docs/official-docs-registry.md

- pnpm is VERIFIED with primary pin 10.4.x and referenced internal docs under /docs/official-docs/EPIC-A (pnpm-workspaces, policy, CI guidance); our task must note the existing divergence because repo uses pnpm@10.28.1.
- Turborepo is VERIFIED at 2.x in the registry but the code-gate brief highlights the need to pin the exact release prior to implementation; this plan must surface that requirement in the documentation produced.

---

## Toolchain Version Authority

Source: /docs/toolchain-versions.md

- pnpm primary pin: 10.4.x (example `packageManager`: pnpm@10.4.0); the registry and plan must acknowledge the repo currently records pnpm@10.28.1 and retain that entry.
- Turbo major: 2.x with 2.1.x primary pin; the pin for this task is explicitly `turbo": "^2.1.3"`, so the plan must require that version string in every reference (package.json, turbo.json, docs, tests).

---

## Code Scout Facts (Constraints)

Source: /docs/code-scout/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A7_Scripts & Commands.md

- /forgea-monorepo/package.json enumerates root scripts `build`, `dev`, and `lint` each invoking `turbo run <task>`, plus `packageManager`: `pnpm@10.28.1` and workspaces `apps/*`, `packages/*`, `services/*`.
- /.github/copilot-instructions.md documents that `pnpm install`, `pnpm dev`, `pnpm build`, and `pnpm lint` all delegate to Turbo, but no conventional README exists at the repo root.
- No root-level `test` script that runs `turbo run test` is defined; some workspaces define local `test` entries but there is no monorepo-wide alias.

---

## Scope (Binding)

### In Scope

- Preserve the existing root script delegation for `build`, `dev`, and `lint` and add a `test` script (`turbo run test`) while keeping `pnpm@10.28.1` as the `packageManager` declaration.
- Produce or update a repo README section that lists the supported `pnpm` commands (`install`, `dev`, `build`, `lint`, `test`), explains their Turbo delegation, and references the pinned pnpm/Turbo versions (once the Turbo pin is resolved).
- Extend `turbo.json` or a new internal doc (suggested path: `/docs/official-docs/EPIC-A/A7_scripts_official.md`) to describe how Turbo maps those commands and what naming conventions contributors should follow.
- Create the verification plan at `/docs/tests/task-A7-tests.md` listing every canonical command plus the tooling pins so QA knows what to exercise.

### Out of Scope

- Touching apps/packages/services source beyond manifest script lists.
- Changing other tooling versions (Node, ESLint, etc.) unrelated to this script catalog.
- Implementing or running tests; only documentation and command declarations are in scope.

---

## Locked Decisions (Derived from Documentation)

1. Root scripts must delegate to Turbo (`turbo run build`, `turbo run dev`, `turbo run lint`) because the code-scout report records those entries and the README must reflect that existing truth. Source: /docs/code-scout/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A7_Scripts & Commands.md
2. `pnpm` CLI behavior is governed by version 10.28.1 in this repo, so documentation must cite that exact pin when describing commands. Source: /docs/toolchain-versions.md (enforcing pnpm pin) and repo manifest.
3. Turborepo orchestration must cite a specific 2.x release (`turbo": "^2.1.3"`); until that version is recorded everywhere the plan is blocked. Source: /docs/docs-gatekeeper/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A7_Scripts & Commands.md

---

## Open Questions (Must Be Resolved)

- None; the Turborepo pin is resolved to `turbo": "^2.1.3"` and must be used everywhere it is referenced.

---

## Invariants (Must Not Be Violated)

- The repo remains a pnpm + Turborepo monorepo with deterministic installs.
- Turbo delegation for the existing scripts is preserved while the new `test` alias is introduced.
- All documentation references the pinned pnpm 10.28.1 and the agreed Turbo 2.x version.

---

## Step-by-Step Plan (Non-Code)

1. Confirm `/forgea-monorepo/package.json` lists `packageManager`: `pnpm@10.28.1` and scripts `build`, `dev`, `lint`; add `"test": "turbo run test"` without altering the existing entries.
2. Draft or update `/forgea-monorepo/README.md` with a "Scripts & Commands" section that enumerates `pnpm install`, `pnpm dev`, `pnpm build`, `pnpm lint`, and `pnpm test`, explains that each command forwards to `turbo run <task>`, and includes the pinned pnpm (10.28.1) and Turbo (`^2.1.3`) versions.
3. Enhance `/forgea-monorepo/turbo.json` or a new `/docs/official-docs/EPIC-A/A7_scripts_official.md` document with a short description of how Turbo maps the root `build/dev/lint/test` tasks, the expected naming conventions for future scripts, and a reference to the tooling pins (`pnpm@10.28.1`, `turbo": "^2.1.3"`) for cognitive alignment.
4. Reference `.github/copilot-instructions.md` only as supplemental Athena but ensure the README is the canonical contributor-facing guide per the code-scout observation.
5. Produce `/docs/tests/task-A7-tests.md` with verification steps that list each canonical `pnpm` command, the Turbo delegation, and the versions QA must verify (pnpm 10.28.1, Turbo 2.x pin).

---

## Files Expected to Modify

- forgea-monorepo/package.json
- forgea-monorepo/README.md
- forgea-monorepo/turbo.json
- docs/official-docs/EPIC-A/A7_scripts_official.md
- docs/tests/task-A7-tests.md

---

## Files to NOT Touch

- forgea-monorepo/apps/\*\*
- forgea-monorepo/packages/\*\*
- forgea-monorepo/services/\*\*
- forgea-monorepo/infra/\*\*
- database schema or migration files under packages or services

---

## Verification Criteria (Machine-Checkable)

- Root script list includes `build`, `dev`, `lint`, and the new `test`, all invoking `turbo run <task>` with `packageManager` staying `pnpm@10.28.1`.
- README documents the supported `pnpm` commands and their Turbo delegation plus cites the pinned tools.
- Turbo doc (`turbo.json` or /docs/official-docs/EPIC-A/A7_scripts_official.md) describes the same commands and tooling versions.
- `/docs/tests/task-A7-tests.md` lists each command, versions, and verification actions for QA.
- All manifests and docs reference `turbo": "^2.1.3"` when describing Turbo as part of the tooling pins.

---

## Risks & Tradeoffs

- Risk: Removing or altering the existing Turbo-backed scripts would break contributor expectations; the plan adds `test` only while preserving all others.
- Risk: If any documentation or manifest omits the `turbo": "^2.1.3"` pin, audits lose traceability; the plan must verify version references.
- Tradeoff: Documenting the script catalog now reduces confusion for contributors and QA.

---

## Dependencies

- Blocked by: Naming the exact Turborepo 2.x release to use (per Docs Gatekeeper). Once supplied, the same pin must be used everywhere.
- Unlocks: Unified contributor guidance, consistent root command invocation, and a verifiable QA checklist.
