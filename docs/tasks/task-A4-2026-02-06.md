# Task A4 — TypeScript Base Configuration

Date: 2026-02-06
Status: APPROVED

---

## Goal

Confirm and document the canonical TypeScript base configuration for the monorepo, align project configs with the approved TypeScript version, and resolve configuration inconsistencies.

---

## Docs Gatekeeper Findings (Advisory)

Source: /docs/docs-gatekeeper/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A4_TypeScript Base Configuration.md

- Required official docs: TypeScript `tsconfig` reference (5.9.3), including `target`, `moduleResolution`, and `strict` semantics.
- Required internal docs to add/extend:
  - /docs/official-docs/EPIC-A/A4_typescript_official.md
  - /docs/official-docs/EPIC-A/typescript-tsconfig-guidelines.md
- Master docs registry updates required for the A4 gatekeeper brief and the required internal doc.

Planner note: Both internal docs currently show version_pinned: false and are BLOCKED; they must be updated to pin TypeScript 5.9.3 before implementation.

---

## Documentation Registry Alignment

Source: /docs/official-docs-registry.md

- TypeScript is VERIFIED with version 5.9.3 and official sources:
  - https://www.typescriptlang.org/tsconfig
  - https://www.typescriptlang.org/docs/handbook/project-references.html
- Internal doc registered:
  - /docs/official-docs/EPIC-A/A4_typescript_official.md

---

## Toolchain Version Authority

Source: /docs/toolchain-versions.md

- TypeScript primary pin: 5.9.3
- Toolchain document is the single source of truth for tool versions.

---

## Code Scout Facts (Constraints)

Source: /docs/code-scout/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A4_TypeScript Base Configuration.md

- Canonical base config exists at /forgea-monorepo/packages/config/tsconfig.base.json with:
  - target: ES2022
  - moduleResolution: "Bundler"
  - strict: true
- Root /forgea-monorepo/tsconfig.json extends the base and sets paths/baseUrl/include.
- App and package configs extend the base and set app-specific overrides.
- Inconsistency observed: base uses "Bundler" while one app uses "bundler".

---

## Scope (Binding)

### In Scope

- Pin and document the canonical TypeScript base configuration and its location.
- Align tsconfig inheritance rules across apps/packages with approved policy.
- Resolve the `moduleResolution` casing inconsistency.
- Update required internal docs to reflect TypeScript 5.9.3 and project conventions.
- Update master documentation registry entries per Docs Gatekeeper.

### Out of Scope

- Application runtime or business logic changes.
- Any changes to build systems unrelated to TypeScript configuration.
- Rewriting or relocating configs unless explicitly required by policy.

---

## Locked Decisions (Derived from Documentation)

1. TypeScript version must be pinned to 5.9.3 per toolchain policy.
   Source: /docs/toolchain-versions.md

2. `tsconfig` options must follow the official TypeScript configuration reference.
   Sources: https://www.typescriptlang.org/tsconfig

---

## Resolved Decisions (User-Approved)

### Canonical Base Location (Resolved)

- The canonical TypeScript base configuration lives at:
  forgea-monorepo/packages/config/tsconfig.base.json
- The base config MUST NOT be relocated.
- All root, app, and package tsconfig files MUST extend this base.

### Allowed Overrides Policy (Resolved)

- The base tsconfig defines all core compiler semantics.
- The following options MUST NOT be overridden:
  target, module, moduleResolution, strict, noEmit,
  useDefineForClassFields, skipLibCheck, incremental.
- Per-project overrides are allowed ONLY for:
  lib, jsx, types, baseUrl, paths (additive),
  outDir, rootDir, references.
- Any other override requires explicit documentation and review.

### moduleResolution Casing (Resolved)

- moduleResolution MUST be set to "Bundler" (capital B) everywhere.

---

## Invariants (Must Not Be Violated)

- Type-checking remains deterministic across the monorepo.
- No changes to application runtime behavior.
- TypeScript version pin remains aligned with toolchain policy.

---

## Step-by-Step Plan (Non-Code)

1. Update /docs/official-docs/EPIC-A/A4_typescript_official.md to pin TypeScript 5.9.3 and document the canonical base config location and rationale.
2. Update /docs/official-docs/EPIC-A/typescript-tsconfig-guidelines.md to pin TypeScript 5.9.3 and define allowed overrides.
3. Align `moduleResolution` casing across all configs (choose the canonical casing per TypeScript docs).
4. Confirm root and per-app tsconfig files extend the canonical base and comply with policy.
5. Append required entries to /docs/master_docs.md per Docs Gatekeeper instructions.
6. Define verification checks for version pinning and config consistency.

---

## Files Expected to Modify

- forgea-monorepo/packages/config/tsconfig.base.json
- forgea-monorepo/tsconfig.json
- forgea-monorepo/apps/\*\*/tsconfig.json
- forgea-monorepo/packages/\*\*/tsconfig.json
- docs/official-docs/EPIC-A/A4_typescript_official.md
- docs/official-docs/EPIC-A/typescript-tsconfig-guidelines.md
- docs/master_docs.md

---

## Files to NOT Touch

- forgea-monorepo/apps/**/src/**
- forgea-monorepo/packages/**/src/**
- forgea-monorepo/services/\*\*
- forgea-monorepo/infra/\*\*
- forgea-monorepo/packages/schema/prisma/migrations/\*\* (LOCKED)

---

## Verification Criteria (Machine-Checkable)

- Base config location is explicitly documented and consistent across all tsconfig extends.
- `moduleResolution` casing is consistent across all tsconfig files.
- Internal TypeScript docs are pinned to 5.9.3 and reflect the canonical base configuration rules.
- master_docs.md includes the A4 entries required by the Docs Gatekeeper brief.

---

## Risks & Tradeoffs

- Relocating the base config could require many file updates and risk path mistakes.
- Inconsistent module resolution settings can cause tooling disagreements between tsc and bundlers.

---

## Dependencies

- Blocked by: Resolution of canonical base location and allowed override policy.
- Unlocks: Consistent TypeScript configuration across the monorepo.
