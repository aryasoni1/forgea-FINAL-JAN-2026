# Task A5 — ESLint (Minimal & Safe)

Date: 2026-02-06
Status: APPROVED

---

## Goal

Establish a minimal, version-pinned ESLint setup that is deterministic across the monorepo, with a canonical shared config and CI guidance that prevents lint failures.

---

## Docs Gatekeeper Findings (Advisory)

Source: /docs/docs-gatekeeper/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A5_ESLint (Minimal & Safe).md

- Required official docs: ESLint core and eslint-plugin-boundaries (version pin listed as UNKNOWN in the brief).
- Required internal docs to extend: /docs/official-docs/eslint-boundaries.md and /docs/official-docs/eslint-ci-guidelines.md.
- Master docs registry updates required for A5 gatekeeper brief and eslint-ci-guidelines doc.

Planner note: Registry and toolchain now provide version pins for ESLint and eslint-plugin-boundaries; these supersede the gatekeeper “unknown” state.

---

## Documentation Registry Alignment

Source: /docs/official-docs-registry.md

- ESLint is VERIFIED with primary pin 9.39.x and official source https://eslint.org/docs/latest
- eslint-plugin-boundaries is VERIFIED with primary pin 4.2.x and official source https://github.com/bryanrsmith/eslint-plugin-boundaries
- Internal docs registered:
  - /docs/official-docs/EPIC-A/eslint-ci-guidelines.md
  - /docs/official-docs/EPIC-A/eslint-boundaries.md

---

## Toolchain Version Authority

Source: /docs/toolchain-versions.md

- ESLint primary pin: 9.39.x
- eslint-plugin-boundaries primary pin: 4.2.x
- Toolchain document is the single source of truth for tool versions.

---

## Code Scout Facts (Constraints)

Source: /docs/code-scout/EPIC-A — MONOREPO & DEVELOPER TOOLING FOUNDATION/A5_ESLint (Minimal & Safe).md

- Root lint script: `turbo run lint` in forgea-monorepo/package.json.
- App lint scripts: `eslint .` in forgea-admin and forgea-lessons.
- `packages/config` exists and is described as shared TS & ESLint config, but no ESLint config files are present.
- No root or package-level ESLint config files found.
- `.turbo` logs show `eslint: command not found` (lint invoked without ESLint installed).

---

## Scope (Binding)

### In Scope

- Pin ESLint and eslint-plugin-boundaries versions per toolchain policy.
- Define the canonical location and format for the shared ESLint config.
- Establish minimal lint rules and boundaries policy consistent with official docs.
- Document CI lint guidance to prevent missing ESLint errors.
- Update master documentation registry entries per Docs Gatekeeper.

### Out of Scope

- Application runtime or business logic changes.
- CI pipeline wiring beyond documentation guidance.
- Non-minimal ESLint rule expansion beyond baseline and boundaries enforcement.

---

## Locked Decisions (Derived from Documentation)

1. ESLint must be pinned to 9.39.x per toolchain policy.
   Source: /docs/toolchain-versions.md

2. eslint-plugin-boundaries must be pinned to 4.2.x per toolchain policy.
   Source: /docs/toolchain-versions.md

---

## Resolved Decisions (User-Approved)

### Canonical ESLint Config Location (Resolved)

- The shared ESLint configuration MUST live at:
  forgea-monorepo/packages/config/eslint.config.js
- No app or package may define its own independent ESLint ruleset.
- Apps and packages MUST reference the shared config.

### ESLint Config Format (Resolved)

- The repository uses ESLint Flat Config exclusively.
- Legacy .eslintrc.\* files are forbidden.
- The canonical config file is eslint.config.js.

### Minimal Rule Policy (Resolved)

- ESLint is used only for:
  - correctness
  - boundary enforcement
  - structural safety
- Formatting, style, and preference rules are explicitly out of scope.
- Prettier is the sole formatting authority.

### CI & Local Safety Guidance (Resolved)

- ESLint MUST be installed as a devDependency at the monorepo root.
- Lint commands MUST be executed only after:
  pnpm install --frozen-lockfile
- If `eslint: command not found` occurs:
  - Verify pnpm install completed
  - Verify devDependencies were not skipped

---

## Invariants (Must Not Be Violated)

- Linting remains deterministic across the monorepo.
- No application runtime behavior changes.
- ESLint and plugin versions remain aligned with toolchain policy.

---

## Step-by-Step Plan (Non-Code)

1. Extend /docs/official-docs/eslint-boundaries.md to pin ESLint and eslint-plugin-boundaries versions, and define the shared config format and location.
2. Extend /docs/official-docs/eslint-ci-guidelines.md to document CI lint enforcement and remediation steps for missing ESLint.
3. Define the minimal shared ESLint config contents and how apps/packages reference it.
4. Ensure root and app/package lint scripts reference the shared config in a consistent manner.
5. Append required entries to /docs/master_docs.md per Docs Gatekeeper instructions.
6. Define verification checks for version pinning, config presence, and lint script consistency.

---

## Files Expected to Modify

- forgea-monorepo/package.json
- forgea-monorepo/apps/\*\*/package.json
- forgea-monorepo/packages/config/\*\*
- docs/official-docs/eslint-boundaries.md
- docs/official-docs/eslint-ci-guidelines.md
- docs/master_docs.md

---

## Files to NOT Touch

- forgea-monorepo/apps/**/src/**
- forgea-monorepo/packages/**/src/**
- forgea-monorepo/services/\*\*
- forgea-monorepo/infra/\*\*
- forgea-monorepo/packages/schema/prisma/migrations/\*\* (LOCKED)

---

## Verification Criteria (Machine-Checkable)

- ESLint and eslint-plugin-boundaries are pinned to toolchain-approved versions.
- A shared ESLint config exists at the canonical location and is referenced by app/package lint scripts.
- CI lint guidance documents `pnpm install --frozen-lockfile` and the lint invocation path.
- master_docs.md includes the A5 entries required by the Docs Gatekeeper brief.

---

## Risks & Tradeoffs

- Leaving ESLint unpinned or uninstalled risks CI failures and inconsistent lint results.
- Choosing the wrong config format (flat vs legacy) could require refactoring later.

---

## Dependencies

- Blocked by: Canonical shared config location and config format decision.
- Unlocks: Deterministic linting and enforceable boundaries across the monorepo.
