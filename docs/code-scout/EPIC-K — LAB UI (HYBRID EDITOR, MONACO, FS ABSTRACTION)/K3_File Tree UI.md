FEATURE CONTEXT

- Epic: EPIC-K — LAB UI (HYBRID EDITOR, MONACO, FS ABSTRACTION)
- Feature: K3 — File Tree UI
- Source: docs/agent_orchestrator_output/EPIC-K — LAB UI (HYBRID EDITOR, MONACO, FS ABSTRACTION)/K3_File Tree UI.md


TASKS CHECKED

- Inventory existing file-tree components and relevant packages (forgea-code-scout step).
- Render virtual file tree (task 17 in EPIC-K master tasks).


WHAT ALREADY EXISTS

- forgea-monorepo/apps/forgea-labs/components/workspace/file-explorer.tsx — Client-side `FileExplorer` component. Renders a nested tree from a hardcoded `fileStructure` array of `FileNode` objects; supports expand/collapse and file selection.
- forgea-monorepo/apps/forgea-labs/components/workspace/monaco-editor.tsx — `MonacoEditor` placeholder component that displays code from a hardcoded `codeExamples` map and shows breadcrumbs and a locked overlay; does not instantiate `monaco` or use `@monaco-editor/react`.
- forgea-monorepo/apps/forgea-labs/components/workspace/main-shell.tsx — `MainShell` composes `FileExplorer` and `MonacoEditor`, holds `selectedFile` state, verification flows, and consoles/modals. This is the active workspace wiring point.
- forgea-monorepo/apps/forgea-labs/package.json — declares `@monaco-editor/react` dependency; pnpm lockfiles include `monaco-editor` versions present in the repo.
- docs/agent_orchestrator_output/EPIC-K — contains the orchestrator feature file for K3 (the source of this task) and related EPIC-K orchestrator files (K1..K4).
- docs/tasks/master_tasks_V1/EPIC-K — master tasks list references K3 and the requirement to render the virtual file tree.


WHAT IS PARTIALLY IMPLEMENTED

- File explorer UI: present and functional as a client-side component, but backed by a static `fileStructure` constant rather than a runtime/virtual FS.
- Editor integration: a visual editor area exists but it is a placeholder using `codeExamples` rather than the Monaco editor API.
- App wiring: `MainShell` connects explorer → editor via `selectedFile`, demonstrating the intended UX flow, but without backend/data integration.


WHAT IS MISSING

- Runtime-backed virtual file system or tree-fetch API endpoints (no `/api/files` or tree-fetch routes found).
- FS abstraction package/service implementing VFS rules, metadata (hidden/read-only markers), and permission metadata — not found.
- Integration of real Monaco editor in `MonacoEditor` component (component is a mock; dependency exists but is unused in source).
- Explicit UX invariants and failure-mode document for file-tree behaviors (hidden markers, disable-selection rules, read-only overlays) — planner-architect deliverable not found.
- Acceptance checklist and tests for file-tree behaviors (not present).


RISKS OR CONFLICTS

- Dependency vs implementation mismatch: `@monaco-editor/react` is declared in dependencies but `MonacoEditor` is a static placeholder; this may mislead implementers about integration status.
- Static mock data in UI could hide backend contract needs — implementers may assume a different tree shape, paging, or metadata fields than required by FS abstraction.
- Multiple apps contain build traces referencing file-tree/lesson explorers (forgea-admin, forgea-lessons). Potential for divergent expectations across apps unless invariants are centralized.


QUESTIONS FOR CLARIFICATION

- None required to continue the planner-architect step; planner should raise clarifying questions if needed.


NEXT AGENT HANDOFF PROMPT

Role: planner-architect

Context: This report (path above) documents the current code-state for K3 — File Tree UI. Key findings: a working client-side `FileExplorer` exists at `apps/forgea-labs/components/workspace/file-explorer.tsx` but uses a hardcoded `fileStructure`; `MonacoEditor` is a visual placeholder at `apps/forgea-labs/components/workspace/monaco-editor.tsx`; `MainShell` wires selection state. No runtime tree-fetch API or FS abstraction package was found.

Task (do not implement):
- Produce `/docs/tasks/task-K3-<YYYY-MM-DD>.md` consuming this code-scout report and the referenced source files.
- The document MUST specify: UX invariants for the file tree (including hidden/read-only markers, selection-disable rules, expected metadata fields), clear failure modes and error semantics, required backend contracts (shapes of tree and file metadata), and an acceptance checklist (including edge-cases and tests the implementer should run).
- List any locked decisions (things the implementer MUST NOT change without planner approval).
- If any information is missing that prevents writing the UX invariants (e.g., required metadata keys), list minimal questions to resolve — do NOT invent fields.

Stop and wait for approval after producing the task doc. Reference this code-scout report when delivering the task doc.


---

Report generated by forgea-code-scout on repository state.
